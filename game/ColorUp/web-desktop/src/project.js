window.__require=function t(e,o,i){function n(r,c){if(!o[r]){if(!e[r]){var a=r.split("/");if(a=a[a.length-1],!e[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(s)return s(a,!0);throw new Error("Cannot find module '"+r+"'")}}var h=o[r]={exports:{}};e[r][0].call(h.exports,function(t){return n(e[r][1][t]||t)},h,h.exports,t,e,o,i)}return o[r].exports}for(var s="function"==typeof __require&&__require,r=0;r<i.length;r++)n(i[r]);return n}({circleDouble:[function(t,e,o){"use strict";cc._RF.push(e,"0ff0aKPMAJOcobSa5/wMMfS","circleDouble"),cc.Class({extends:cc.Component,properties:{starNode:{default:null,type:cc.Node}},onLoad:function(){},start:function(){},update:function(t){},setColors:function(t,e,o){for(o>e.length&&(o=e.length),this.optionalColors=[],this.optionalColors[0]=t;this.optionalColors.length<o;){var i=e[parseInt(Math.random()*o)];this.optionalColors.includes(i)||(this.optionalColors[this.optionalColors.length]=i)}var n=!0,s=!1,r=void 0;try{for(var c,a=this.node.children[Symbol.iterator]();!(n=(c=a.next()).done);n=!0){var l;if((l=c.value)!=this.starNode)(l=l.getComponent("circle")).setColors(t,this.optionalColors,o),l.hideStar()}}catch(t){s=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}}}),cc._RF.pop()},{}],circle:[function(t,e,o){"use strict";cc._RF.push(e,"bc2d5v7+iVGHL6aJ4+fFqzJ","circle"),cc.Class({extends:cc.Component,properties:{starNode:{default:null,type:cc.Node},duration:0,reverse:!1},onLoad:function(){var t=this.reverse?-360:360;this.node.runAction(cc.repeatForever(cc.rotateBy(this.duration,t))),this.starNode.runAction(cc.repeatForever(cc.rotateBy(this.duration,-t)))},start:function(){},update:function(t){},setColors:function(t,e,o){if(o>e.length&&(o=e.length),e.length==o&&e.includes(t))this.optionalColors=e;else for(this.optionalColors=[],this.optionalColors[0]=t;this.optionalColors.length<o;){var i=e[parseInt(Math.random()*o)];this.optionalColors.includes(i)||(this.optionalColors[this.optionalColors.length]=i)}for(var n in this.node.children)this.node.children[n]!=this.starNode&&(this.node.children[n].color=this.optionalColors[n%this.optionalColors.length])},hideStar:function(){this.starNode.active=!1}}),cc._RF.pop()},{}],cross:[function(t,e,o){"use strict";cc._RF.push(e,"e8f5cTJKUBNEK5q+aj45TuO","cross"),cc.Class({extends:cc.Component,properties:{duration:0,crossNode:{default:null,type:cc.Node}},onLoad:function(){this.crossNode.runAction(cc.repeatForever(cc.rotateBy(this.duration,360)))},start:function(){},update:function(t){},setColors:function(t,e,o){for(o>e.length&&(o=e.length),this.optionalColors=[],this.optionalColors[0]=t;this.optionalColors.length<o;){var i=e[parseInt(Math.random()*o)];this.optionalColors.includes(i)||(this.optionalColors[this.optionalColors.length]=i)}for(var n in this.crossNode.children)this.crossNode.children[n].color=this.optionalColors[n%this.optionalColors.length]}}),cc._RF.pop()},{}],gameOver:[function(t,e,o){"use strict";cc._RF.push(e,"30572cjelJPB5qEQ+HumiPY","gameOver"),cc.Class({extends:cc.Component,properties:{currentScoreNode:{default:null,type:cc.Node},highestScoreRootNode:{default:null,type:cc.Node},historyNode:{default:null,type:cc.Node},firstScoreNode:{default:null,type:cc.Node},secondScoreNode:{default:null,type:cc.Node},thirdScoreNode:{default:null,type:cc.Node},friendTopRankingNode:{default:null,type:cc.Node},friendTopRankingWXSubContextView:{default:null,type:cc.WXSubContextView},friendRankingNode:{default:null,type:cc.Node}},onLoad:function(){var t=this.node.getComponent("gameResult");if(this.currentScoreNode.getComponent(cc.Label).string=t.getLastScore(),cc.sys.platform===cc.sys.WECHAT_GAME){this.historyNode.active=!1,this.friendTopRankingNode.active=!0,this.highestScoreRootNode.active=!0,this.highestScoreRootNode.getChildByName("Score").getComponent(cc.Label).string=window.userInfo.highestScore;var e=t.getLastScore();e>window.userInfo.highestScore&&(window.userInfo.highestScore=e,wx.cloud.callFunction({name:"uploadHighestScore",data:{score:e},success:function(t){cc.log(t)},fail:function(t){cc.error(t)}})),wx.getOpenDataContext().postMessage({type:"updateScore",score:e}),wx.getOpenDataContext().postMessage({type:"showFriendTopRanking"})}else{this.highestScoreRootNode.active=!1,this.friendTopRankingNode.active=!1,this.historyNode.active=!0;var o=t.getHistoryScores();this.firstScoreNode.getComponent(cc.Label).string=o[0],this.secondScoreNode.getComponent(cc.Label).string=o[1],this.thirdScoreNode.getComponent(cc.Label).string=o[2]}},start:function(){},update:function(t){},playAgain:function(){cc.sys.platform===cc.sys.WECHAT_GAME&&wx.getOpenDataContext().postMessage({type:"close"}),cc.director.loadScene("Game")},showFriendRanking:function(){var t=this;this.friendTopRankingWXSubContextView.enabled=!1,this.isLoadedFriendRanking||(wx.getOpenDataContext().postMessage({type:"showFriendRanking"}),this.isLoadedFriendRanking=!0),this.friendRankingNode.on(cc.Node.EventType.TOUCH_START,function(){}),this.friendRankingNode.active=!0,this.friendRankingNode.opacity=0,this.scheduleOnce(function(e){return t.friendRankingNode.opacity=255},.1)},hideFriendRanking:function(){this.friendRankingNode.active=!1}}),cc._RF.pop()},{}],gameResult:[function(t,e,o){"use strict";cc._RF.push(e,"d50a8spJZZLtbk78WqITNcg","gameResult"),cc.Class({extends:cc.Component,properties:{lastScoreKey:{default:"lastScore",visible:!1},historyScoresKey:{default:"historyScores",visible:!1}},onLoad:function(){},start:function(){},update:function(t){},setNewScore:function(t){cc.sys.localStorage.setItem(this.lastScoreKey,t);var e=this.getHistoryScores();e||(e=[0,0,0]),e.push(t);for(var o=e.length-1;o>0&&e[o]>e[o-1];o--){var i=e[o];e[o]=e[o-1],e[o-1]=i}e.pop(),cc.sys.localStorage.setItem(this.historyScoresKey,JSON.stringify(e))},getLastScore:function(){return cc.sys.localStorage.getItem(this.lastScoreKey)},getHistoryScores:function(){var t=cc.sys.localStorage.getItem(this.historyScoresKey);return t?JSON.parse(t):t}}),cc._RF.pop()},{}],game:[function(t,e,o){"use strict";cc._RF.push(e,"61219/eGQFGG6GNY+cG5sr4","game"),cc.Class({extends:cc.Component,properties:{colors:{default:[],type:[cc.Color]},operateTipNode:{default:null,type:cc.Node},player:{default:null,type:t("player")},obstacleSet:{default:null,type:t("obstacleSet")},giftCollector:{default:null,type:t("giftCollector")}},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.player.game=this,this.player.setJumpTopListener(function(t,e){this.obstacleSet.moveDown(t,e)}.bind(this)),this.obstacleSet.setColors(this.colors),this.node.once(cc.Node.EventType.TOUCH_START,this.hideOperateTip,this),this.node.on(cc.Node.EventType.TOUCH_START,this.player.jump,this.player),cc.sys.platform===cc.sys.WECHAT_GAME&&(wx.cloud.init(),this._getUserInfo())},start:function(){},update:function(t){},_getUserInfo:function(){wx.cloud.callFunction({name:"getUserInfo",data:{},success:function(t){window.userInfo=t.result,wx.getOpenDataContext().postMessage({type:"userInfo",userInfo:window.userInfo})},fail:function(t){cc.error(t)}})},hideOperateTip:function(){this.operateTipNode.active=!1,this.operateTipNode.parent.removeChild(this.operateTipNode),delete this.operateTipNode},gameOver:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.player.jump,this.player),this.node.getComponent("gameResult").setNewScore(this.giftCollector.getScore()),cc.director.loadScene("GameOver")},captureStar:function(t){this.giftCollector.captureStar(t)}}),cc._RF.pop()},{giftCollector:"giftCollector",obstacleSet:"obstacleSet",player:"player"}],giftCollector:[function(t,e,o){"use strict";cc._RF.push(e,"f4e4cR+yhlN/rkSav8Ddl11","giftCollector"),cc.Class({extends:cc.Component,properties:{starScoreNode:{default:null,type:cc.Node}},onLoad:function(){this.starCount=0,this.score=0},start:function(){},update:function(t){},captureStar:function(t){this.starCount+=1,this.score+=t,this.starScoreNode.getComponent(cc.Label).string=this.score.toString()},getScore:function(){return this.score}}),cc._RF.pop()},{}],lineSeries:[function(t,e,o){"use strict";cc._RF.push(e,"f8170o+K8dDpLMm2hNVluRx","lineSeries"),cc.Class({extends:cc.Component,properties:{linePrefab:{default:null,type:cc.Prefab},starNode:{default:null,type:cc.Node},lineMargin:0,speed:0},onLoad:function(){this.canvasWidth=cc.find("Canvas").width,this.left=-this.canvasWidth/2,this.starNode.zIndex=9,this.lines=[];for(var t=cc.instantiate(this.linePrefab),e=0;e<this.canvasWidth/t.width+2;e++){t=cc.instantiate(this.linePrefab);this.node.addChild(t),t.setPosition(new cc.v2(-this.canvasWidth/2+(t.width+this.lineMargin)*e,0)),this.lines[e]=t}},start:function(){},update:function(t){var e=this.lines[0];if(e.x<this.left-e.width){var o=this.lines[this.lines.length-1];e.x=o.x+o.width+this.lineMargin,this.optionalColors&&this.updateLineColor(e),this.lines.shift(),this.lines.push(e)}var i=!0,n=!1,s=void 0;try{for(var r,c=this.lines[Symbol.iterator]();!(i=(r=c.next()).done);i=!0){r.value.x-=this.speed}}catch(t){n=!0,s=t}finally{try{!i&&c.return&&c.return()}finally{if(n)throw s}}},setColors:function(t,e,o){for(o>e.length&&(o=e.length),this.optionalColors=[],this.optionalColors[0]=t;this.optionalColors.length<o;){var i=e[parseInt(Math.random()*o)];this.optionalColors.includes(i)||(this.optionalColors[this.optionalColors.length]=i)}var n=!0,s=!1,r=void 0;try{for(var c,a=this.lines[Symbol.iterator]();!(n=(c=a.next()).done);n=!0){var l=c.value;this.updateLineColor(l)}}catch(t){s=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(s)throw r}}},updateLineColor:function(t){this.usingColorTimes||(this.usingColorTimes=0),t.color=this.optionalColors[Math.floor(this.usingColorTimes/2)%this.optionalColors.length],this.usingColorTimes++}}),cc._RF.pop()},{}],line:[function(t,e,o){"use strict";cc._RF.push(e,"f4b4aQWMPlIjKN39BdpAeLe","line"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var t=this.node.getComponent(cc.Collider);t.size.width=this.node.width,t.size.height=this.node.height},start:function(){},update:function(t){},onCollisionEnter:function(t){}}),cc._RF.pop()},{}],obstacleSet:[function(t,e,o){"use strict";cc._RF.push(e,"43f0fkRjSlEFb/tAY0jjxXb","obstacleSet"),cc.Class({extends:cc.Component,properties:{player:{default:null,type:t("player")},obstaclesPrefab:{default:[],type:[cc.Prefab]},startObstaclePrefab:{default:null,type:cc.Prefab},palettePrefab:{default:null,type:cc.Prefab},protectiveProbability:.05,protectiveCoverPrefab:{default:null,type:cc.Prefab}},onLoad:function(){var t=cc.find("Canvas");this.node.width=t.width,this.node.height=t.height,this.obstacleMargin=this.node.height/3,this.palletePool=new cc.NodePool},start:function(){this.createObstacle(this.obstacleMargin,this.createPallete(this.obstacleMargin),this.startObstaclePrefab)},update:function(t){},setColors:function(t){this.optionalColors=t,this.primaryColor=t[0],this.usingColorCount=0},moveDown:function(t,e){var o=this.node.children[1];o.y+o.height/2<-this.node.height/2&&(this.node.removeChild(o),"palette"==o.group&&this.palletePool.put(o));var i=this.node.children[this.node.childrenCount-1],n=i.y+i.height/2;if(n<this.node.height/2){var s=n+this.obstacleMargin;this.createObstacle(s,this.createPallete(s))}var r=!0,c=!1,a=void 0;try{for(var l,h=this.node.children[Symbol.iterator]();!(r=(l=h.next()).done);r=!0){var d=l.value;"DeadLine"!=d.name&&d.runAction(cc.moveBy(e,cc.v2(0,t>0?-t:t)))}}catch(t){c=!0,a=t}finally{try{!r&&h.return&&h.return()}finally{if(c)throw a}}},createPallete:function(t){var e=this.palletePool.get();e||(e=cc.instantiate(this.palettePrefab)),this.node.addChild(e),e.setPosition(new cc.v2(0,t-this.obstacleMargin/2+e.height/2));var o=e.getComponent("palette").setColors(this.optionalColors,this.lastPrimaryColor);if(this.lastPrimaryColor=o,Math.random()<this.protectiveProbability){var i=cc.instantiate(this.protectiveCoverPrefab);this.node.addChild(i),i.setPosition(new cc.v2(e.x,e.y))}return o},createObstacle:function(t,e,o){this.usingColorCount<this.optionalColors.length&&this.usingColorCount++,o||(o=this.obstaclesPrefab[parseInt(Math.random()*this.obstaclesPrefab.length)]);var i=cc.instantiate(o);this.node.addChild(i),i.setPosition(new cc.v2(0,t+i.height/2));var n=i.name[0].toLowerCase()+i.name.slice(1);i.getComponent(n).setColors(e,this.optionalColors,this.usingColorCount)}}),cc._RF.pop()},{player:"player"}],palette:[function(t,e,o){"use strict";cc._RF.push(e,"3bdc4DT+OtOmYT6giwGdXUP","palette"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},start:function(){},update:function(t){},onCollisionEnter:function(t){this.node.parent.removeChild(this.node),this.node.active=!1},setColors:function(t,e){return this.colors=t,this.exceptColor=e,this.getPrimaryColor()},getPrimaryColor:function(){if(!this.primaryColor)do{this.primaryColor=this.colors[parseInt(Math.random()*this.colors.length)]}while(this.primaryColor==this.exceptColor);return this.primaryColor}}),cc._RF.pop()},{}],player:[function(t,e,o){"use strict";cc._RF.push(e,"0dd3dxX/GhM4artdMGzoTXt","player"),cc.Class({extends:cc.Component,properties:{jumpHeight:0,jumpDuration:0,sinkDuration:0,deadEffectPrefab:{default:null,type:cc.Prefab},deadAudioClip:{default:null,type:cc.AudioClip},capturedGiftAudioClip:{default:null,type:cc.AudioClip},protectivePBNode:{default:null,type:cc.Node}},onLoad:function(){this.updateStyle(this.node.color)},start:function(){},update:function(t){},setJumpTopListener:function(t){this.jumpTopListener=t},jump:function(){this.node.stopAllActions();var t=this.jumpHeight;this.node.y+this.jumpHeight>0&&(t=-this.node.y,this.jumpTopListener(this.jumpHeight,this.jumpDuration));var e=cc.moveBy(this.jumpDuration,cc.v2(0,t)).easing(cc.easeCubicActionOut()),o=-this.node.parent.height/2,i=cc.moveBy(this.sinkDuration,cc.v2(0,o)).easing(cc.easeCubicActionIn());this.node.runAction(cc.sequence(e,i))},updateStyle:function(t){this.node.color=t;var e=this.node.getComponent(cc.ParticleSystem);e.startColor=t,e.endColor=t},protective:function(t){this.isProtectived&&this.unschedule(this.updateProtective),this.isProtectived=!0;var e=this.node.getComponent(cc.ParticleSystem);e.startColorVarCache||(e.startColorVarCache=new cc.Color,e.startColorVarCache.set(e.startColorVar)),e.startColorVar=cc.Color.WHITE,this.protectivePBNode.active=!0;var o=this.protectivePBNode.getComponent(cc.ProgressBar);o.progress=1;o.step=o.totalLength/(t/.016),this.schedule(this.updateProtective,.016)},updateProtective:function(){var t=this.protectivePBNode.getComponent(cc.ProgressBar);if(t.progress-=t.step,!(t.progress>0)){this.isProtectived=!1;var e=this.node.getComponent(cc.ParticleSystem);e.startColorVar=e.startColorVarCache,this.protectivePBNode.active=!1,this.unschedule(this.updateProtective)}},gameOver:function(){if(this.node.active){var t=cc.instantiate(this.deadEffectPrefab);this.node.parent.addChild(t),t.setPosition(cc.v2(this.node.x,this.node.y)),this.node.active=!1,cc.audioEngine.play(this.deadAudioClip,!1,.3),this.scheduleOnce(this.game.gameOver.bind(this.game),1)}},onCollisionEnter:function(t){switch(t.node.group){case"obstacle":this.isProtectived||t.node.color.equals(this.node.color)||this.gameOver();break;case"gift":this.game.captureStar(t.node.getComponent("star").score),cc.audioEngine.play(this.capturedGiftAudioClip,!1,.3);break;case"palette":this.updateStyle(t.node.getComponent("palette").getPrimaryColor());break;case"protective":this.protective(t.node.getComponent("protectiveCover").protectiveDuration)}}}),cc._RF.pop()},{}],protectiveCover:[function(t,e,o){"use strict";cc._RF.push(e,"dd02ermAdBNhapvm6qVkD0a","protectiveCover"),cc.Class({extends:cc.Component,properties:{protectiveDuration:5},onLoad:function(){},start:function(){},update:function(t){},getCover:function(){return this.node.getComponent(cc.Sprite).spriteFrame},onCollisionEnter:function(t){this.node.parent.removeChild(this.node)}}),cc._RF.pop()},{}],star:[function(t,e,o){"use strict";cc._RF.push(e,"a38f8w4Cu1Gy4wL3UeClKbN","star"),cc.Class({extends:cc.Component,properties:{score:0,capturedEffectPrefab:{default:null,type:cc.Prefab}},onLoad:function(){},start:function(){},update:function(t){},unuse:function(){this.node.active=!1},reuse:function(){this.node.active=!0},onCollisionEnter:function(t){var e=cc.instantiate(this.capturedEffectPrefab);this.node.parent.addChild(e),e.setPosition(cc.v2(this.node.x,this.node.y)),e.zIndex=this.node.zIndex,this.node.parent.removeChild(this.node),this.node.active=!1}}),cc._RF.pop()},{}]},{},["circle","circleDouble","cross","game","gameOver","gameResult","giftCollector","line","lineSeries","obstacleSet","palette","player","protectiveCover","star"]);